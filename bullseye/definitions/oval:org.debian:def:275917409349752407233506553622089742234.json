{
	"id": "oval:org.debian:def:275917409349752407233506553622089742234",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-40974 linux-6.1",
		"affected": {
			"family": "unix",
			"platform": "Debian GNU/Linux 11",
			"product": "linux-6.1"
		},
		"reference": [
			{
				"source": "CVE",
				"ref_id": "CVE-2024-40974",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-40974"
			}
		],
		"description": "In the Linux kernel, the following vulnerability has been resolved:  powerpc/pseries: Enforce hcall result buffer validity and size  plpar_hcall(), plpar_hcall9(), and related functions expect callers to provide valid result buffers of certain minimum size. Currently this is communicated only through comments in the code and the compiler has no idea.  For example, if I write a bug like this:    long retbuf[PLPAR_HCALL_BUFSIZE]; // should be PLPAR_HCALL9_BUFSIZE   plpar_hcall9(H_ALLOCATE_VAS_WINDOW, retbuf, ...);  This compiles with no diagnostics emitted, but likely results in stack corruption at runtime when plpar_hcall9() stores results past the end of the array. (To be clear this is a contrived example and I have not found a real instance yet.)  To make this class of error less likely, we can use explicitly-sized array parameters instead of pointers in the declarations for the hcall APIs. When compiled with -Warray-bounds[1], the code above now provokes a diagnostic like this:  error: array argument is too small; is of size 32, callee requires at least 72 [-Werror,-Warray-bounds]    60 |                 plpar_hcall9(H_ALLOCATE_VAS_WINDOW, retbuf,       |                 ^                                   ~~~~~~  [1] Enabled for LLVM builds but not GCC for now. See commit     0da6e5fd6c37 (\"gcc: disable '-Warray-bounds' for gcc-13 too\") and     related changes.",
		"debian": {}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterias": [
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.debian.oval:tst:2",
								"comment": "all architecture"
							},
							{
								"test_ref": "oval:org.debian.oval:tst:31166",
								"comment": "linux-6.1 DPKG is earlier than 6.1.119-1~deb11u1"
							}
						]
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.debian.oval:tst:1",
				"comment": "Debian 11 is installed"
			}
		]
	}
}
