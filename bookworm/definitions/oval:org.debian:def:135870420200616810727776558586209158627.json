{
	"id": "oval:org.debian:def:135870420200616810727776558586209158627",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2021-47084 linux",
		"affected": {
			"family": "unix",
			"platform": "Debian GNU/Linux 12",
			"product": "linux"
		},
		"reference": [
			{
				"source": "CVE",
				"ref_id": "CVE-2021-47084",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47084"
			}
		],
		"description": "In the Linux kernel, the following vulnerability has been resolved:  hamradio: defer ax25 kfree after unregister_netdev  There is a possible race condition (use-after-free) like below   (USE)                       |  (FREE) ax25_sendmsg                 |  ax25_queue_xmit             |   dev_queue_xmit             |    __dev_queue_xmit          |     __dev_xmit_skb           |      sch_direct_xmit         | ...       xmit_one               |        netdev_start_xmit     | tty_ldisc_kill         __netdev_start_xmit  |  mkiss_close          ax_xmit             |   kfree           ax_encaps          |                              |  Even though there are two synchronization primitives before the kfree: 1. wait_for_completion(&ax->dead). This can prevent the race with routines from mkiss_ioctl. However, it cannot stop the routine coming from upper layer, i.e., the ax25_sendmsg.  2. netif_stop_queue(ax->dev). It seems that this line of code aims to halt the transmit queue but it fails to stop the routine that already being xmit.  This patch reorder the kfree after the unregister_netdev to avoid the possible UAF as the unregister_netdev() is well synchronized and won't return if there is a running routine.",
		"debian": {}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterias": [
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.debian.oval:tst:2",
								"comment": "all architecture"
							},
							{
								"test_ref": "oval:org.debian.oval:tst:22412",
								"comment": "linux DPKG is earlier than 5.15.15-1"
							}
						]
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.debian.oval:tst:1",
				"comment": "Debian 12 is installed"
			}
		]
	}
}
