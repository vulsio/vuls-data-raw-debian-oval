{
	"id": "oval:org.debian:def:242529005051765303960398966069965598031",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2022-48997 linux",
		"affected": {
			"family": "unix",
			"platform": "Debian GNU/Linux 12",
			"product": "linux"
		},
		"reference": [
			{
				"source": "CVE",
				"ref_id": "CVE-2022-48997",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-48997"
			}
		],
		"description": "In the Linux kernel, the following vulnerability has been resolved:  char: tpm: Protect tpm_pm_suspend with locks  Currently tpm transactions are executed unconditionally in tpm_pm_suspend() function, which may lead to races with other tpm accessors in the system.  Specifically, the hw_random tpm driver makes use of tpm_get_random(), and this function is called in a loop from a kthread, which means it's not frozen alongside userspace, and so can race with the work done during system suspend:    tpm tpm0: tpm_transmit: tpm_recv: error -52   tpm tpm0: invalid TPM_STS.x 0xff, dumping stack for forensics   CPU: 0 PID: 1 Comm: init Not tainted 6.1.0-rc5+ #135   Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.0-20220807_005459-localhost 04/01/2014   Call Trace:    tpm_tis_status.cold+0x19/0x20    tpm_transmit+0x13b/0x390    tpm_transmit_cmd+0x20/0x80    tpm1_pm_suspend+0xa6/0x110    tpm_pm_suspend+0x53/0x80    __pnp_bus_suspend+0x35/0xe0    __device_suspend+0x10f/0x350  Fix this by calling tpm_try_get_ops(), which itself is a wrapper around tpm_chip_start(), but takes the appropriate mutex.  [Jason: reworked commit message, added metadata]",
		"debian": {}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterias": [
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.debian.oval:tst:2",
								"comment": "all architecture"
							},
							{
								"test_ref": "oval:org.debian.oval:tst:25962",
								"comment": "linux DPKG is earlier than 6.0.12-1"
							}
						]
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.debian.oval:tst:1",
				"comment": "Debian 12 is installed"
			}
		]
	}
}
