{
	"id": "oval:org.debian:def:209022943177089069099637500161267636411",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2021-47026 linux",
		"affected": {
			"family": "unix",
			"platform": "Debian GNU/Linux 12",
			"product": "linux"
		},
		"reference": [
			{
				"source": "CVE",
				"ref_id": "CVE-2021-47026",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47026"
			}
		],
		"description": "In the Linux kernel, the following vulnerability has been resolved:  RDMA/rtrs-clt: destroy sysfs after removing session from active list  A session can be removed dynamically by sysfs interface \"remove_path\" that eventually calls rtrs_clt_remove_path_from_sysfs function.  The current rtrs_clt_remove_path_from_sysfs first removes the sysfs interfaces and frees sess->stats object. Second it removes the session from the active list.  Therefore some functions could access non-connected session and access the freed sess->stats object even-if they check the session status before accessing the session.  For instance rtrs_clt_request and get_next_path_min_inflight check the session status and try to send IO to the session.  The session status could be changed when they are trying to send IO but they could not catch the change and update the statistics information in sess->stats object, and generate use-after-free problem. (see: \"RDMA/rtrs-clt: Check state of the rtrs_clt_sess before reading its stats\")  This patch changes the rtrs_clt_remove_path_from_sysfs to remove the session from the active session list and then destroy the sysfs interfaces.  Each function still should check the session status because closing or error recovery paths can change the status.",
		"debian": {}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterias": [
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.debian.oval:tst:2",
								"comment": "all architecture"
							},
							{
								"test_ref": "oval:org.debian.oval:tst:22341",
								"comment": "linux DPKG is earlier than 5.10.38-1"
							}
						]
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.debian.oval:tst:1",
				"comment": "Debian 12 is installed"
			}
		]
	}
}
